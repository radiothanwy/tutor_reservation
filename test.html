<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reservation System Test</title>
  <script src="js/secure-config.js"></script>
</head>
<body>
  <h1>Reservation System Test</h1>

  <button id="checkConfig">Check Config</button>
  <button id="healthCheck">Run Health Check</button>
  <button id="submitTest">Submit Dummy Reservation</button>

  <pre id="output"></pre>

  <script>
    function log(msg) {
      document.getElementById('output').textContent += msg + "\n";
      console.log(msg);
    }

    // Wait until secureApiClient is available
    document.getElementById("checkConfig").addEventListener("click", () => {
      if (window.secureApiClient) {
        log("✅ secureApiClient initialized");
        log("API URL: " + window.secureApiClient.config.API_URL);
        log("API Key: " + window.secureApiClient.config.API_KEY.substring(0,8) + "... (hidden)");
      } else {
        log("❌ secureApiClient not available");
      }
    });

    document.getElementById("healthCheck").addEventListener("click", async () => {
      try {
        const result = await window.secureApiClient.healthCheck();
        log("✅ Health check passed: " + JSON.stringify(result, null, 2));
      } catch (err) {
        log("❌ Health check failed: " + err.message);
      }
    });

    document.getElementById("submitTest").addEventListener("click", async () => {
      const dummyData = {
        firstName: "Test",
        lastName: "User",
        email: "test@example.com",
        phone: "+1234567890",
        grade: "10",
        gender: "M",
        englishLevel: "Intermediate",
        preferredDays: "Mon, Wed",
        preferredTime: "Afternoon",
        sessionLength: "60 minutes",
        learningGoals: "Math practice"
      };

      try {
        const result = await window.secureApiClient.submitForm(dummyData);
        log("✅ Dummy reservation submitted: " + JSON.stringify(result, null, 2));
      } catch (err) {
        log("❌ Submission failed: " + err.message);
      }
    });
  </script>
</body>
</html>
